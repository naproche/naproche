%%
%% This is file `naproche.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% naproche.dtx  (with options: `package')
%% 
%% Copyright (C) 2025 Marcel SchÃ¼tz
%% 
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either
%% version 1.3 of this license or (at your option) any later
%% version. The latest version of this license is in:
%% 
%%     http://www.latex-project.org/lppl.txt
%% 
%% and version 1.3c or later is part of all distributions of
%% LaTeX version 2008-05-04 or later.
%% 

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{naproche}[2025-09-27 v1.0.1 Basic LaTeX package for Naproche formalization]

\RequirePackage{amsfonts}
\RequirePackage{xspace}
\RequirePackage{xcolor}
\RequirePackage{mdframed}
\RequirePackage{linegoal}
\RequirePackage{amsmath}
\RequirePackage{url}

%% Preliminary Setup
%% =================

\newbool{naproche@forthel}
\newbool{naproche@puzzle}
\newcounter{naproche@tlscounter}

%% Package Options
%% ===============

\DeclareOption{puzzle}{
  \setbool{naproche@puzzle}{true}
}
\DeclareOption{numberswithinsection}{
  \counterwithin{naproche@tlscounter}{section}
}
\DeclareOption{numberswithinsubsection}{
  \counterwithin{naproche@tlscounter}{subsection}
}
\DeclareOption*{
  \PackageWarning{naproche}{Unknown option `\CurrentOption'}
}
\ProcessOptions\relax

%% Commands Required by ForTheL
%% ============================

\NewDocumentCommand{\dom}{}{\textrm{dom}}
\NewDocumentCommand{\fun}{}{\mathrm{\lambda}}

%% Logos
%% =====

\NewDocumentCommand{\Naproche}{}{\mbox{\ensuremath{\mathbb{N}}aproche}\xspace}
\NewDocumentCommand{\ForTheL}{}{\mbox{ForTheL}\xspace}

%% Comprehension Terms
%% ===================

\NewDocumentCommand{\naproche@lproj}{m m}{#1}
\NewDocumentCommand{\naproche@rproj}{m m}{#2}
\NewDocumentCommand{\class}{>{\SplitArgument{1}{|}} m}{
  \left\{\naproche@lproj#1~\middle\vert~\naproche@rproj#1\right\}
}
\NewDocumentCommand{\classtext}{m}{\parbox{\linegoal}{#1}}

%% Printing Labels
%% ===============

\NewDocumentCommand{\printref}{m}{\path{#1}}

%% The ForTheL Environment
%% =======================

\colorlet{naproche@forthelgray}{lightgray!30}
\NewDocumentEnvironment{forthel}{}{
  \begin{mdframed}[backgroundcolor=naproche@forthelgray,linecolor=naproche@forthelgray]
  \setbool{naproche@forthel}{true}
  \setlength{\parindent}{0pt}
  \setlength{\parskip}{0.5em}
}{
  \end{mdframed}
  \setbool{naproche@forthel}{false}
}

%% Top-level Section Environments
%% ==============================

\NewDocumentCommand{\naproche@SetCurrentLabelName}{m}{
  \protected@edef\@currentlabelname{#1}
}
\NewDocumentCommand{\naproche@NewTLS@standard}{m m}{
  \NewDocumentEnvironment{#1}{o}{
    \refstepcounter{naproche@tlscounter}
    \par
    \ifbool{naproche@forthel}{}{\vspace{0.5em}}
    \noindent\textbf{#2~\thenaproche@tlscounter\IfValueT{##1}{~(##1)}.}%
    \IfValueT{##1}{\naproche@SetCurrentLabelName{##1}}%
  }{
    \par
    \ifbool{naproche@forthel}{}{\vspace{0.5em}}
  }
  \NewDocumentEnvironment{#1*}{o}{
    \par
    \ifbool{naproche@forthel}{}{\vspace{0.5em}}
    \noindent\textbf{#2\IfValueT{##1}{~(##1)}.}%
    \IfValueT{##1}{\naproche@SetCurrentLabelName{##1}}%
  }{
    \par
    \ifbool{naproche@forthel}{}{\vspace{0.5em}}
  }
}
\NewDocumentCommand{\naproche@NewTLS@puzzle}{m o}{
  \NewDocumentEnvironment{#1}{}{\unskip\IfValueT{#2}{#2}}{\unskip}
  \NewDocumentEnvironment{#1*}{}{\unskip\IfValueT{#2}{#2}}{\unskip}
}
\ifbool{naproche@puzzle}{
  \naproche@NewTLS@puzzle{signature}
  \naproche@NewTLS@puzzle{axiom}
  \naproche@NewTLS@puzzle{definition}
  \naproche@NewTLS@puzzle{theorem}[Therefore:]
  \naproche@NewTLS@puzzle{lemma}[Therefore:]
  \naproche@NewTLS@puzzle{proposition}[Therefore:]
  \naproche@NewTLS@puzzle{corollary}[Therefore:]
  \naproche@NewTLS@puzzle{convention}
}{
  \naproche@NewTLS@standard{signature}{Signature}
  \naproche@NewTLS@standard{definition}{Definition}
  \naproche@NewTLS@standard{axiom}{Axiom}
  \naproche@NewTLS@standard{theorem}{Theorem}
  \naproche@NewTLS@standard{lemma}{Lemma}
  \naproche@NewTLS@standard{proposition}{Proposition}
  \naproche@NewTLS@standard{corollary}{Corollary}
  \naproche@NewTLS@standard{convention}{Convention}
}

%% The Proof Environment
%% =====================

\NewDocumentEnvironment{proof}{o}{
  \par
  \ifbool{naproche@forthel}{}{\vspace{0.5em}}
  \noindent\textit{Proof\IfValueT{#1}{~#1}.}%
}
{
  \hfill\ensuremath{\square}
  \par
}
\endinput
%%
%% End of file `naproche.sty'.
