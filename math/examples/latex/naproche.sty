%%
%% This is file `naproche.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% naproche.dtx  (with options: `package')
%% 
%% Copyright (C) 2025 Marcel SchÃ¼tz
%% 
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either
%% version 1.3 of this license or (at your option) any later
%% version. The latest version of this license is in:
%% 
%%     http://www.latex-project.org/lppl.txt
%% 
%% and version 1.3c or later is part of all distributions of
%% LaTeX version 2008-05-04 or later.
%% 

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{naproche}[2025-10-08 v1.0.2 Basic LaTeX package for Naproche formalization]

\RequirePackage{amsfonts}
\RequirePackage{xspace}
\RequirePackage{xcolor}
\RequirePackage{mdframed}
\RequirePackage{linegoal}
\RequirePackage{amsmath}
\RequirePackage{url}


%% Preliminary Setup
%% =================

\newbool{@forthel}

\newbool{@puzzle}

\newcounter{@tlscounter}


%% Package Options
%% ===============

\DeclareOption{puzzle}{
  \setbool{@puzzle}{true}
}

\DeclareOption{numberswithinsection}{
  \counterwithin{@tlscounter}{section}
}

\DeclareOption{numberswithinsubsection}{
  \counterwithin{@tlscounter}{subsection}
}

\DeclareOption*{
  \PackageWarning{naproche}{Unknown option `\CurrentOption'}
}

\ProcessOptions\relax


%% Commands Required by ForTheL
%% ============================

\NewDocumentCommand{\dom}{}{\textrm{dom}}

\NewDocumentCommand{\fun}{}{\mathrm{\lambda}}


%% Logos
%% =====

\NewDocumentCommand{\Naproche}{}{\mbox{\ensuremath{\mathbb{N}}aproche}\xspace}

\NewDocumentCommand{\ForTheL}{}{\mbox{ForTheL}\xspace}


%% Comprehension Terms
%% ===================

\NewDocumentCommand{\@lproj}{m m}{#1}
\NewDocumentCommand{\@rproj}{m m}{#2}

\NewDocumentCommand{\class}{>{\SplitArgument{1}{|}} m}{
  \left\{\@lproj#1~\middle\vert~\@rproj#1\right\}
}

\NewDocumentCommand{\classtext}{m}{\parbox{\linegoal}{#1}}


%% Printing Labels
%% ===============

\NewDocumentCommand{\printref}{m}{\path{#1}}


%% The ForTheL Environment
%% =======================

\colorlet{@forthelgray}{lightgray!30}

\NewDocumentEnvironment{forthel}{}{
  \begin{mdframed}[backgroundcolor=@forthelgray,linecolor=@forthelgray]
  \setbool{@forthel}{true}
  \setlength{\parindent}{0pt}
  \setlength{\parskip}{0.5em}
}{
  \end{mdframed}
  \setbool{@forthel}{false}
}


%% Top-level Section Environments
%% ==============================

\NewDocumentCommand{\@SetCurrentLabelName}{m}{
  \protected@edef\@currentlabelname{#1}
}


%% Markup for the Standard Layout
%% ------------------------------

\NewDocumentCommand{\@NewTLS@standard}{m m}{
  \NewDocumentEnvironment{#1}{o}{
    \refstepcounter{@tlscounter}
    \par
    \ifbool{@forthel}{}{\vspace{0.5em}}
    \noindent\textbf{#2~\the@tlscounter\IfValueT{##1}{~(##1)}.}%
    \IfValueT{##1}{\@SetCurrentLabelName{##1}}%
  }{
    \par
    \ifbool{@forthel}{}{\vspace{0.5em}}
  }
}

\NewDocumentCommand{\@NewTLS@standard@starred}{m m}{
  \NewDocumentEnvironment{#1}{o}{
    \par
    \ifbool{@forthel}{}{\vspace{0.5em}}
    \noindent\textbf{#2\IfValueT{##1}{~(##1)}.}%
    \IfValueT{##1}{\@SetCurrentLabelName{##1}}%
  }{
    \par
    \ifbool{@forthel}{}{\vspace{0.5em}}
  }
}


%% Markup for the Puzzle Layout
%% ----------------------------

\NewDocumentCommand{\@NewTLS@puzzle}{m o}{
  \NewDocumentEnvironment{#1}{}{\unskip\IfValueT{#2}{#2}}{\unskip}
}


%% Defining Top-Level Section Environments
%% ---------------------------------------


%% Signatures
%% ..........

\ifbool{@puzzle}{
  \@NewTLS@puzzle{signature}
  \@NewTLS@puzzle{signature*}
}{
  \@NewTLS@standard{signature}{Signature}
  \@NewTLS@standard@starred{signature*}{Signature}
}


%% Axioms
%% ......

\ifbool{@puzzle}{
  \@NewTLS@puzzle{axiom}
  \@NewTLS@puzzle{axiom*}
}{
  \@NewTLS@standard{axiom}{Axiom}
  \@NewTLS@standard@starred{axiom*}{Axiom}
}


%% Definitions
%% ...........

\ifbool{@puzzle}{
  \@NewTLS@puzzle{definition}
  \@NewTLS@puzzle{definition*}
}{
  \@NewTLS@standard{definition}{Definition}
  \@NewTLS@standard@starred{definition*}{Definition}
}


%% Assertions
%% ..........

\ifbool{@puzzle}{
  \@NewTLS@puzzle{theorem}[Therefore:]
  \@NewTLS@puzzle{theorem*}[Therefore:]
  \@NewTLS@puzzle{lemma}[Therefore:]
  \@NewTLS@puzzle{lemma*}[Therefore:]
  \@NewTLS@puzzle{proposition}[Therefore:]
  \@NewTLS@puzzle{proposition*}[Therefore:]
  \@NewTLS@puzzle{corollary}[Therefore:]
  \@NewTLS@puzzle{corollary*}[Therefore:]
}{
  \@NewTLS@standard{theorem}{Theorem}
  \@NewTLS@standard@starred{theorem*}{Theorem}
  \@NewTLS@standard{lemma}{Lemma}
  \@NewTLS@standard@starred{lemma*}{Lemma}
  \@NewTLS@standard{proposition}{Proposition}
  \@NewTLS@standard@starred{proposition*}{Proposition}
  \@NewTLS@standard{corollary}{Corollary}
  \@NewTLS@standard@starred{corollary*}{Corollary}
}


%% Conventions
%% ...........

\ifbool{@puzzle}{
  \@NewTLS@puzzle{convention}
  \@NewTLS@puzzle{convention*}
}{
  \@NewTLS@standard{convention}{Convention}
  \@NewTLS@standard@starred{convention*}{Convention}
}


%% The Proof Environment
%% =====================

\NewDocumentEnvironment{proof}{o}{
  \par
  \ifbool{@forthel}{}{\vspace{0.5em}}
  \noindent\textit{Proof\IfValueT{#1}{~#1}.}%
}
{
  \hfill\ensuremath{\square}
  \par
}

\endinput
%%
%% End of file `naproche.sty'.
