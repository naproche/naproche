\documentclass{naproche-library}
\libinput{preamble}
\begin{document}
\IfInputref{}{\setsectionlevel{section}}
\begin{smodule}[title=Euclid's Division Theorem]{eulid-division-theorem.ftl}
\importmodule[libraries/arithmetics]{multiplication-and-ordering.ftl}
\importmodule[libraries/arithmetics]{subtraction.ftl}

\begin{theorem}[forthel,title=Euclid's Division Theorem: Existence,id=euclid_existence]
  Let $n, m$ be natural numbers such that $m \neq \NATzero$.
  Then there exist natural numbers $q, r$ such that
  \[n \eq (m \NATmul q) \NATplus r\]
  and $r \NATless m$.
\end{theorem}
\begin{proof}[forthel]
  (a) Define $\Phi = \{ n' \in \Nat \mid \text{ there exist natural numbers }q, r\text{ such that }r \NATless m\text{ and }n' \eq (m \NATmul q) \NATplus r \}$.

  (1) $\Phi$ contains $\NATzero$.
  \begin{proof}
    Take $q \eq \NATzero$ and $r \eq \NATzero$.
    Then $r \NATless m$ and $\NATzero \eq (m \NATmul q) \NATplus r$.
    Hence $\NATzero \in \Phi$.
  \end{proof}

  (2) For all $n' \in \Phi$ we have $n' \NATplus \NATone \in \Phi$.
  \begin{proof}
    Let $n' \in \Phi$.

    Let us show that there exist natural numbers $q, r$ such that $r \NATless m$ and $n' \NATplus \NATone \eq (m \NATmul q) \NATplus r$.
      Take natural numbers $q', r'$ such that $r' \NATless m$ and $n' \eq (m \NATmul q') \NATplus r'$ (by a).
      We have $r' \NATplus \NATone \NATless m$ or $r' \NATplus \NATone \eq m$.

      \begin{case}{$r' \NATplus \NATone \NATless m$.}
        Take $q \eq q' \NATplus \NATzero$ and $r \eq r' \NATplus \NATone$. %!
        Then $r \NATless m$ and $n' \NATplus \NATone
          \eq ((q' \NATmul m) \NATplus r') \NATplus \NATone
          \eq (q' \NATmul m) \NATplus (r' \NATplus \NATone)
          \eq (q \NATmul m) \NATplus r$.
      \end{case}

      \begin{case}{$r' \NATplus \NATone \eq m$.}
        Take  $q \eq q' \NATplus \NATone$ and $r \eq \NATzero$.
        Then $r \NATless m$ and
        $n' \NATplus \NATone
          \eq ((q' \NATmul m) \NATplus r') \NATplus \NATone
          \eq (q' \NATmul m) \NATplus (r' \NATplus \NATone)
          \eq (q' \NATmul m) \NATplus m
          \eq (q' \NATmul m) \NATplus (\NATone \NATmul m)
          \eq (q' \NATplus \NATone) \NATmul m
          \eq (q \NATmul m) \NATplus r$.
      \end{case}
    End.

    Hence $n' \NATplus \NATone \in \Phi$.
  \end{proof}

  Then $\Phi$ contains every natural number (by \printref{ARITHMETIC_01_4764664342773760}).
  Thus there exist natural numbers $q, r$ such that $n \eq (m \NATmul q) \NATplus r$ and $r \NATless m$ (by a).
\end{proof}

\begin{theorem}[forthel,title=Euclid's Division Theorem: Uniqueness,id=euclid_uniqueness]
  Let $n, m$ be natural numbers such that $m \neq \NATzero$.
  Let $q, r$ be natural numbers such that
  \[n \eq (m \NATmul q) \NATplus r\]
  and $r \NATless m$.
  Let $q', r'$ be natural numbers such that
  \[n \eq (m \NATmul q') \NATplus r'\]
  and $r' \NATless m$.
  Then $q \eq q'$ and $r \eq r'$.
\end{theorem}
\begin{proof}[forthel]
  We have $(m \NATmul q) \NATplus r \eq (m \NATmul q') \NATplus r'$.

  \begin{case}{$q \NATgeq q'$ and $r \NATgeq r'$.}
    (1) $((m \NATmul q) \NATplus r) \NATsub r' \eq (m \NATmul q) \NATplus (r \NATsub r')$ (by \printref{ARITHMETIC_05_7578468875239424}).
    (2) $((m \NATmul q') \NATplus r') \NATsub r'
      \eq (m \NATmul q') \NATplus (r' \NATsub r')
      \eq m \NATmul q'$.
    Hence $(m \NATmul q) \NATplus (r \NATsub r') \eq m \NATmul q'$.
    Thus $((m \NATmul q) \NATsub (m \NATmul q')) \NATplus (r \NATsub r') \eq \NATzero$.
    Consequently $(m \NATmul q) \NATsub (m \NATmul q') \eq \NATzero$ and $r \NATsub r' \eq \NATzero$.
    If $(m \NATmul q) \NATsub (m \NATmul q') \eq \NATzero$ then $q \NATsub q' \eq \NATzero$.
    Therefore $q \NATsub q' \eq \NATzero$ and $r \NATsub r' \eq \NATzero$.
    Thus we have $q \eq q'$ and $r \eq r'$.
  \end{case}

  \begin{case}{$q \NATgeq q'$ and $r \NATless r'$.}
    Take $q'' \eq q \NATsub q'$ and $r'' \eq r' \NATsub r$.
    Then $(m \NATmul (q' \NATplus q'')) \NATplus r \eq (m \NATmul q') \NATplus (r \NATplus r'')$.
    We have $(m \NATmul q') \NATplus (r \NATplus r'')
      \eq (m \NATmul q') \NATplus (r'' \NATplus r)
      \eq ((m \NATmul q') \NATplus r'') \NATplus r$.
    Hence $(m \NATmul (q' \NATplus q'')) \NATplus r \eq ((m \NATmul q') \NATplus r'') \NATplus r$.
    Thus $m \NATmul (q' \NATplus q'') \eq (m \NATmul q') \NATplus r''$ (by \printref{ARITHMETIC_03_3137702874578944}).
    We have $m \NATmul (q' \NATplus q'') \eq (m \NATmul q') \NATplus (m \NATmul q'')$.
    Hence $(m \NATmul q') \NATplus (m \NATmul q'') \eq (m \NATmul q') \NATplus r''$.
    Thus $m \NATmul q'' \eq r''$ (by \printref{ARITHMETIC_03_8445946379632640}).
    Then we have $m \NATmul q'' \NATless m \NATmul \NATone$.
    Indeed $m \NATmul q''
      \eq r''
      \NATleq r'
      \NATless m
      \eq m \NATmul \NATone$.
    Therefore $q'' \NATless \NATone$ (by \printref{ARITHMETIC_06_5048640368279552}).
    Consequently $q \NATsub q' \eq q'' \eq \NATzero$.
    Hence $q \eq q'$.
    Thus $(m \NATmul q) \NATplus r \eq (m \NATmul q) \NATplus r'$.
    Therefore $r \eq r'$.
  \end{case}

  \begin{case}{$q \NATless q'$ and $r \NATgeq r'$.}
    Take $q'' \eq q' \NATsub q$ and $r'' \eq r \NATsub r'$.
    Then $(m \NATmul q) \NATplus (r' \NATplus r'') \eq (m \NATmul (q \NATplus q'')) \NATplus r'$.
    We have $(m \NATmul q) \NATplus (r' \NATplus r'')
      \eq (m \NATmul q) \NATplus (r'' \NATplus r')
      \eq ((m \NATmul q) \NATplus r'') \NATplus r'$.
    Hence $((m \NATmul q) \NATplus r'') \NATplus r' \eq (m \NATmul (q \NATplus q'')) \NATplus r'$.
    Thus $(m \NATmul q) \NATplus r'' \eq m \NATmul (q \NATplus q'')$ (by \printref{ARITHMETIC_03_3137702874578944}).
    We have $m \NATmul (q \NATplus q'') \eq (m \NATmul q) \NATplus (m \NATmul q'')$.
    Hence $(m \NATmul q) \NATplus r'' \eq (m \NATmul q) \NATplus (m \NATmul q'')$.
    Thus $r'' \eq m \NATmul q''$ (by \printref{ARITHMETIC_03_8445946379632640}).
    Then we have $m \NATmul q'' \NATless m \NATmul \NATone$.
    Indeed $m \NATmul q''
      \eq r''
      \NATleq r
      \NATless m
      \eq m \NATmul \NATone$.
    Therefore $q'' \NATless \NATone$ (by \printref{ARITHMETIC_06_5048640368279552}).
    Consequently $q' \NATsub q \eq q'' \eq \NATzero$.
    Hence $q' \eq q$.
    Thus $(m \NATmul q) \NATplus r \eq (m \NATmul q) \NATplus r'$.
    Therefore $r \eq r'$.
  \end{case}

  \begin{case}{$q \NATless q'$ and $r \NATless r'$.}
    (1) $((m \NATmul q') \NATplus r') \NATsub r \eq (m \NATmul q') \NATplus (r' \NATsub r)$ (by \printref{ARITHMETIC_05_7578468875239424}).
    (2) $((m \NATmul q) \NATplus r) \NATsub r
      \eq (m \NATmul q) \NATplus (r \NATsub r)
      \eq m \NATmul q$.
    Hence $(m \NATmul q') \NATplus (r' \NATsub r) \eq m \NATmul q$.
    Thus $((m \NATmul q') \NATsub (m \NATmul q)) \NATplus (r' \NATsub r)
      \eq ((m \NATmul q') \NATplus (r' \NATsub r)) \NATsub (m \NATmul q)
      \eq \NATzero$.
    Consequently $(m \NATmul q') \NATsub (m \NATmul q) \eq \NATzero$ and $r' \NATsub r \eq \NATzero$.
    If $(m \NATmul q') \NATsub (m \NATmul q) \eq \NATzero$ then $q' \NATsub q \eq \NATzero$.
    Therefore $q' \NATsub q \eq \NATzero$ and $r' \NATsub r \eq \NATzero$.
    Thus we have $q' \eq q$ and $r' \eq r$.
  \end{case}
\end{proof}
\end{smodule}
\end{document}
