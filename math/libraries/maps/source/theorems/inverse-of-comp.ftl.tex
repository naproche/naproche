\documentclass{naproche-library}
\libinput{preamble}
\begin{document}
\begin{smodule}[title=The Inverse of a Composition]{inverse-of-comp.ftl}

\importmodule[libraries/maps]{definitions?surjections-between-classes.ftl}
\importmodule[libraries/maps]{definitions?inverse-map.ftl}
\importmodule[libraries/maps]{definitions?comp.ftl}
\importmodule[libraries/maps]{definitions?id.ftl}

\begin{proposition}[forthel,id=InvertibilityOfCompProp]
  Let $A, B, C$ be classes and $f \fromonto{A}{B}$ and $g \fromonto{B}{C}$.
  Assume that $f$ and $g$ are invertible.
  Then $g \compo f$ is invertible and $\inv{g \compo f} \eq \inv{f} \compo \inv{g}$.
\end{proposition}
\begin{proof}[forthel]
  $\inv{f}$ is a surjective map from $B$ onto $A$.
  $\inv{g}$ is a surjective map from $C$ onto $B$.
  Take $h = \inv{f} \compo \inv{g}$.
  Then $h$ is a surjective map from $C$ onto $A$.
  $g \compo f$ is a map from $A$ to $C$.

  Let us show that $((g \compo f) \compo h) \eq \id{C}$.
    We have $f \compo (\inv{f} \compo \inv{g}) \eq (f \compo \inv{f}) \compo \inv{g}$.
    Indeed $f \compo (\inv{f} \compo \inv{g})$ and $(f \compo \inv{f}) \compo \inv{g}$ are maps of $C$.
    $f \compo h$ is a map from $C$ to $B$.
    Hence
    \[  (g \compo f) \compo h                           \]
    \[    \eq g \compo (f \compo h)                       \]
    \[    \eq g \compo (f \compo (\inv{f} \compo \inv{g}))   \]
    \[    \eq g \compo ((f \compo \inv{f}) \compo \inv{g})   \]
    \[    \eq g \compo (\id{B} \compo \inv{g})            \]
    \[    \eq g \compo \inv{g}                            \]
    \[    \eq \id{C}.                                  \]
  End.

  Let us show that $h \compo (g \compo f) \eq \id{A}$.
    We have $(\inv{f} \compo \inv{g}) \compo g \eq \inv{f} \compo (\inv{g} \compo g)$.
    $g \compo f$ is a map from $A$ to $C$.
    Hence
    \[  h \compo (g \compo f)                           \]
    \[    \eq (h \compo g) \compo f                       \]
    \[    \eq ((\inv{f} \compo \inv{g}) \compo g) \compo f   \]
    \[    \eq (\inv{f} \compo (\inv{g} \compo g)) \compo f   \]
    \[    \eq (\inv{f} \compo \id{B}) \compo f            \]
    \[    \eq \inv{f} \compo f                            \]
    \[    \eq \id{A}.                                  \]
  End.

  Thus $h$ is the inverse of $g \compo f$.
  Indeed $g \compo f$ is a surjective map from $A$ onto $C$ and $h$ is a surjective map from $C$ onto $A$.
\end{proof}

\end{smodule}
\end{document}