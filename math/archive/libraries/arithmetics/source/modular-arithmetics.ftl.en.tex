\documentclass{stex}
\libusepackage{naproche}
\libinput{preamble}
\begin{document}
\begin{smodule}{modular-arithmetics.ftl}
\importmodule[libraries/arithmetics]{multiplication-and-ordering.ftl}
\symdef{NATdiv}{\,\textrm{div}\,}
\symdef{NATmod}{\,\textrm{mod}\,}
\symdef{NATcong}[args=3]{#1\mathrel{\comp\equiv}#2\;\comp{(\textrm{mod}}\,#3\comp)}

\begin{sfragment}{Quotients and Remainders}
  \begin{definition}[forthel]
    Let $n, m$ be natural numbers such that $m \NotEq \NATzero$.
    $\emph{n \NATdiv m}$ is the natural number $q$ such that $n \Eq (m \NATmul q) \NATplus r$ for some natural number $r$ that is less than $m$.
    Let the \emph{quotient of $n$ over $m$} stand for $n \NATdiv m$.
  \end{definition}

  \begin{definition}[forthel]
    Let $n, m$ be natural numbers such that $m \NotEq \NATzero$.
    $\emph{n \NATmod m}$ is the natural number $r$ such that $r \NATless m$ and there exists a natural number $q$ such that $n \Eq (m \NATmul q) \NATplus r$.
    Let the \emph{remainder of $n$ over $m$} stand for $n \NATmod m$.
  \end{definition}
\end{sfragment}

\begin{sfragment}{Basic Properties}
  \begin{definition}[forthel]
    Let $n, m, k$ be natural numbers such that $k \NotEq \NATzero$.
    $\emph{\NATcong{n}{m}{k}}$ iff $n \NATmod k \Eq m \NATmod k$.
    Let $n$ and $m$ are \emph{congruent modulo $k$} stand for $\NATcong{n}{m}{k}$.
  \end{definition}

  \begin{proposition}[forthel]
    Let $n, k$ be natural numbers such that $k \NotEq \NATzero$.
    Then $\NATcong{n}{n}{k}$.
  \end{proposition}
  \begin{proof}[forthel]
    We have $n \NATmod k \Eq n \NATmod k$.
    Hence $\NATcong{n}{n}{k}$.
  \end{proof}

  \begin{proposition}[forthel]
    Let $n, m, k$ be natural numbers such that $k \NotEq \NATzero$.
    If $\NATcong{n}{m}{k}$ then $\NATcong{m}{n}{k}$.
  \end{proposition}
  \begin{proof}[forthel]
    Assume $\NATcong{n}{m}{k}$.
    Then $n \NATmod k \Eq m \NATmod k$.
    Hence $m \NATmod k \Eq n \NATmod k$.
    Thus $\NATcong{m}{n}{k}$.
  \end{proof}

  \begin{proposition}[forthel]
    Let $n, m, k$ be natural numbers such that $k \NotEq \NATzero$.
    If $\NATcong{n}{m}{k}$ and $\NATcong{m}{\NATone}{k}$ then $\NATcong{n}{\NATone}{k}$.
  \end{proposition}
  \begin{proof}[forthel]
    Assume $\NATcong{n}{m}{k}$ and $\NATcong{m}{\NATone}{k}$.
    Then $n \NATmod k \Eq m \NATmod k$ and $m \NATmod k \Eq \NATone \NATmod k$.
    Hence $n \NATmod k \Eq \NATone \NATmod k$.
    Thus $\NATcong{n}{\NATone}{k}$.
  \end{proof}

  \begin{proposition}[forthel]
    Let $n, m, k$ be natural numbers such that $k \NotEq \NATzero$.
    Assume $n \NATgeq m$.
    Then $\NATcong{n}{m}{k}$ iff $n \Eq (k \NATmul x) \NATplus m$ for some natural number $x$.
  \end{proposition}
  \begin{proof}[forthel]
    \begin{case}{$\NATcong{n}{m}{k}$.}
      Then $n \NATmod k \Eq m \NATmod k$.
      Take a natural number $r$ such that $r \NATless k$ and $n \NATmod k \Eq r \Eq m \NATmod k$.
      Take a nonzero natural number $l$ such that $k \Eq r \NATplus l$.
      Consider natural numbers $q,q'$ such that $n \Eq (q \NATmul k) \NATplus r$ and $m \Eq (q' \NATmul k) \NATplus r$.

      Then $q \NATgeq q'$.
      \begin{proof}
        Assume the contrary.
        Then $q \NATless q'$.
        Hence $q \NATmul k \NATless q' \NATmul k$.
        Thus $(q \NATmul k) \NATplus r \NATless (q' \NATmul k) \NATplus r$ (by \sn{preservation of ordering under right-addition}).
        Indeed $q \NATmul k$ and $q' \NATmul k$ are natural numbers.
        Therefore $n \NATless m$.
        Contradiction.
      \end{proof}

      Take a natural number $x$ such that $q \Eq q' \NATplus x$.

      Let us show that $n \Eq (k \NATmul x) \NATplus m$.
        We have
        \[  (k \NATmul x) \NATplus m                       \]
        \[    \Eq (k \NATmul x) \NATplus ((q' \NATmul k) \NATplus r)  \]
        \[    \Eq ((k \NATmul x) \NATplus (q' \NATmul k)) \NATplus r  \]
        \[    \Eq ((k \NATmul x) \NATplus (k \NATmul q')) \NATplus r  \]
        \[    \Eq (k \NATmul (q' \NATplus x)) \NATplus r            \]
        \[    \Eq (k \NATmul q) \NATplus r                   \]
        \[    \Eq n.                                \]
      End.
    \end{case}

    \begin{case}{$n \Eq (k \NATmul x) \NATplus m$ for some natural number $x$.}
      Consider a natural number $x$ such that $n \Eq (k \NATmul x) \NATplus m$.
      Take natural numbers $r, r'$ such that $n \NATmod k \Eq r$ and $m \NATmod k \Eq r'$.
      Then $r, r' \NATless k$.
      Take natural numbers $q, q'$ such that $n \Eq (k \NATmul q) \NATplus r$ and $m \Eq (k \NATmul q') \NATplus r'$.
      Then
      \[  (k \NATmul q) \NATplus r                         \]
      \[    \Eq n                                   \]
      \[    \Eq (k \NATmul x) \NATplus m                     \]
      \[    \Eq (k \NATmul x) \NATplus ((k \NATmul q') \NATplus r')   \]
      \[    \Eq ((k \NATmul x) \NATplus (k \NATmul q')) \NATplus r'   \]
      \[    \Eq (k \NATmul (x \NATplus q')) \NATplus r'.            \]
      Hence $r \Eq r'$.
      Thus $n \NATmod k \Eq m \NATmod k$.
      Therefore $\NATcong{n}{m}{k}$.
    \end{case}
  \end{proof}

  \begin{proposition}[forthel]
    Let $n, m, k, k'$ be natural numbers such that $k, k' \NotEq \NATzero$.
    If $\NATcong{n}{m}{k \NATmul k'}$ then $\NATcong{n}{m}{k}$.
  \end{proposition}
  \begin{proof}[forthel]
    Assume $\NATcong{n}{m}{k \NATmul k'}$.

    \begin{case}{$n \NATgeq m$.}
      We can take a natural number $x$ such that $n \Eq ((k \NATmul k') \NATmul x) \NATplus m$.
      Then $n \Eq (k \NATmul (k' \NATmul x)) \NATplus m$.
      Hence $\NATcong{n}{m}{k}$.
    \end{case}

    \begin{case}{$m \NATgeq n$.}
      We have $\NATcong{m}{n}{k \NATmul k'}$.
      Hence we can take a natural number $x$ such that $m \Eq ((k \NATmul k') \NATmul x) \NATplus n$.
      Then $m \Eq (k \NATmul (k' \NATmul x)) \NATplus n$.
      Thus $\NATcong{m}{n}{k}$.
      Therefore $\NATcong{n}{m}{k}$.
    \end{case}
  \end{proof}

  \begin{corollary}[forthel]
    Let $n, m, k, k'$ be natural numbers such that $k, k' \NotEq \NATzero$.
    If $\NATcong{n}{m}{k \NATmul k'}$ then $\NATcong{n}{m}{k'}$.
  \end{corollary}
  \begin{proof}[forthel]
    Assume $\NATcong{n}{m}{k \NATmul k'}$.
    Then $\NATcong{n}{m}{k' \NATmul k}$.
    Hence $\NATcong{n}{m}{k'}$.
  \end{proof}

  \symdecl*{congruency of sum}
  
  \begin{proposition}[forthel,name=congruency of sum]
    Let $n, k$ be natural numbers such that $k \NotEq \NATzero$.
    Then $\NATcong{n \NATplus k}{n}{k}$.
  \end{proposition}
  \begin{proof}[forthel]
    Take $r = n \NATmod k$ and $r' = (n \NATplus k) \NATmod k$.
    Consider a $q \Elem \Nat$ such that $n \Eq (k \NATmul q) \NATplus r$ and $r \NATless k$.
    Consider a $q' \Elem \Nat$ such that $n \NATplus k \Eq (k \NATmul q') \NATplus r'$ and
    $r' \NATless k$.
    Then $(k \NATmul q') \NATplus r'
      \Eq n \NATplus k
      \Eq ((k \NATmul q) \NATplus r) \NATplus k
      \Eq (k \NATplus (k \NATmul q)) \NATplus r
      \Eq (k \NATmul (q \NATplus \NATone)) \NATplus r$.
    Hence $r \Eq r'$.
    Consequently $n \NATmod k \Eq (n \NATplus k) \NATmod k$.
    Thus $\NATcong{n \NATplus k}{n}{k}$.
  \end{proof}
\end{sfragment}
\end{smodule}
\end{document}
