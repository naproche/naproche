\documentclass{stex}
\libusepackage{naproche}
\libinput{preamble}
\begin{document}
\begin{smodule}{dedekind-recursion-theorem.ftl}
\importmodule[libraries/arithmetics]{nat-is-a-set.ftl}
\importmodule[libraries/set-theory]{zfc.ftl}

\begin{definition}[forthel]
  Let $a$ be an object and $f$ be a map.
  Let $\varphi$ be a map from $\Nat$ to $\Dom(f)$.
  $\varphi$ is \emph{recursively defined by $a$ and $f$} iff $\varphi(\NATzero) = a$ and $\varphi(n \NATplus \NATone) = f(\varphi(n))$ for every $n \Elem \Nat$.
\end{definition}

\symdecl*{Dedekind Recursion Existence}

\begin{theorem}[forthel,title=Dedekind's Recursion Theorem: Existence,name=Dedekind Recursion Existence]
  Let $A$ be a set and $a \Elem A$ and $f \FUNfromto{A}{A}$.
  Then there exists a $\varphi \FUNfromto{\Nat}{A}$ that is recursively defined by $a$ and $f$.
\end{theorem}
\begin{proof}[forthel]
  (a) Define \[ \Phi = \SClass{H}{\SETpow(\Nat \SETprod A)}{\classtext{$(\NATzero, a) \Elem H$ and for all $n \Elem \Nat$ and all $x \Elem A$ if $(n, x) \Elem H$ then $(n \NATplus \NATone, f(x)) \Elem H$}}. \]

  Let us show that $\SETintersectover \Phi \Elem \Phi$.
  \begin{proof}
    (0) $\Nat \SETprod A \Elem \Phi$.
    \begin{proof}
      (i) $\Nat \SETprod A \Elem \SETpow(\Nat \SETprod A)$.

      (ii) $(\NATzero,a) \Elem \Nat \SETprod A$.

      (iii) for all $n \Elem \Nat$ and all $x \Elem A$ if $(n, x) \Elem \Nat \SETprod A$ then $(n \NATplus \NATone, f(x)) \Elem \Nat \SETprod A$.
      \begin{proof}
        Let $n \Elem \Nat$ and $x \Elem A$.
        Assume $(n,x) \Elem \Nat \SETprod A$.
        We have $n \NATplus \NATone \Elem \Nat$ and $f(x) \Elem A$.
        Hence $(n \NATplus \NATone, f(x)) \Elem \Nat \SETprod A$.
      \end{proof}
    \end{proof}

    (1) $\SETintersectover \Phi \Elem \SETpow(\Nat \SETprod A)$.
    \begin{proof}
      Any element of $\SETintersectover \Phi$ is contained in every element of $\Phi$.
      Hence any element of $\SETintersectover \Phi$ is contained in $\Nat \SETprod A$.
      Thus $\SETintersectover \Phi \SETinclude \Nat \SETprod A$.
      $\SETintersectover \Phi$ is a set.
      Hence $\SETintersectover \Phi$ is a subset of $\Nat \SETprod A$.
    \end{proof}

    (2) $(\NATzero, a) \Elem \SETintersectover \Phi$.
    Indeed $(\NATzero, a) \Elem \Nat \SETprod A \Elem \Phi$.

    (3) For all $n \Elem \Nat$ and all $x \Elem A$ if $(n, x) \Elem
    \SETintersectover \Phi$ then $(n \NATplus \NATone, f(x)) \Elem \SETintersectover \Phi$.
    \begin{proof}
      Let $n \Elem \Nat$ and $x \Elem A$.
      Assume $(n, x) \Elem \SETintersectover \Phi$.
      Then $(n, x)$ is contained in every element of $\Phi$.
      Hence $(n \NATplus \NATone, f(x))$ is contained in every element of $\Phi$.
      Thus $(n \NATplus \NATone, f(x)) \Elem \SETintersectover \Phi$.
    \end{proof}

    Therefore $\SETintersectover \Phi \Elem \Phi$ (by a).
  \end{proof}

  Let us show that for any $n \Elem \Nat$ there exists an $x \Elem A$ such
  that $(n, x) \Elem \SETintersectover \Phi$.
  \begin{proof}
    Define $\Psi = \SClass{n}{\Nat}{\text{ there exists an }x \Elem A\text{ such
    that }(n, x) \Elem \SETintersectover \Phi}$.

    (1) $\NATzero$ is contained in $\Psi$.
    Indeed $(\NATzero, a) \Elem \SETintersectover \Phi$.

    (2) For all $n \Elem \Psi$ we have $n \NATplus \NATone \Elem \Psi$.
    \begin{proof}
      Let $n \Elem \Psi$.
      Take an $x \Elem A$ such that $(n, x) \Elem \SETintersectover \Phi$.
      Then $(n \NATplus \NATone, f(x)) \Elem \SETintersectover \Phi$.
      Hence $n \NATplus \NATone \Elem \Psi$.
      Indeed $f(x) \Elem A$.
    \end{proof}

    Therefore $n \Elem \Psi$ for every $n \Elem \Nat$ (by \sr{induction I}{induction}).
  \end{proof}

  Let us show that for all $n \Elem \Nat$ and all $x, y \Elem A$ if
  $(n, x), (n, y) \Elem \SETintersectover \Phi$ then $x \Eq y$.
  \begin{proof}
    (b) Define $\Theta = \SClass{n}{\Nat}{\text{ for all }x, y \Elem A\text{ if }
    (n, x), (n, y) \Elem \SETintersectover \Phi\text{ then }x \Eq y}$.

    (1) $\Theta$ contains $\NATzero$.
    \begin{proof}
      Let us show that for all $x, y \Elem A$ if $(\NATzero, x), (\NATzero, y) \Elem
      \SETintersectover \Phi$ then $x \Eq y$.
        Let $x, y \Elem A$.
        Assume $(\NATzero, x), (\NATzero, y) \Elem \SETintersectover \Phi$.

        Let us show that $x, y \Eq a$.
          Assume $x \NotEq a$ or $y \NotEq a$.

          \begin{case}{$x \NotEq a$.}
            $(\NATzero,x), (\NATzero,a)$ are contained in every element of $\Phi$.
            Then $(\NATzero,x), (\NATzero,a) \Elem \SETintersectover \Phi$.
            Take $H = (\SETintersectover \Phi) \SETdiff \SETsingleton{(\NATzero,x)}$.

            Let us show that $H \Elem \Phi$.
              (1) $H \Elem \SETpow(\Nat \SETprod A)$.

              (2) $(\NATzero,a) \Elem H$.

              (3) For all $n \Elem \Nat$ and all $b \Elem A$ if
              $(n,b) \Elem H$ then $(n \NATplus \NATone, f(b)) \Elem H$.
              \begin{proof}
                Let $n \Elem \Nat$ and $b \Elem A$.
                Assume $(n,b) \Elem H$.
                Then $(n \NATplus \NATone, f(b)) \Elem \SETintersectover \Phi$.
                We have $(n \NATplus \NATone, f(b)) \NotEq (\NATzero,x)$.
                Indeed $n \NATplus \NATone \NotEq \NATzero$.
                Hence $(n \NATplus \NATone, f(b)) \Elem H$.
              \end{proof}

              [prover vampire]
              Thus $H \Elem \Phi$ (by a).
              [prover eprover]
            End.

            Then $(\NATzero,x)$ is not contained in every member of $\Phi$.
            Contradiction.
          \end{case}

          \begin{case}{$y \NotEq a$.}
            $(\NATzero,y), (\NATzero,a)$ are contained in every element of $\Phi$.
            Then $(\NATzero,y), (\NATzero,a) \Elem \SETintersectover \Phi$.
            Take $H = (\SETintersectover \Phi) \SETdiff \SETsingleton{(\NATzero,y)}$.

            Let us show that $H \Elem \Phi$.
              (1) $H \Elem \SETpow(\Nat \SETprod A)$.

              (2) $(\NATzero,a) \Elem H$.
              Indeed $(\NATzero,a) \NotEq (\NATzero,y)$.

              (3) For all $n \Elem \Nat$ and all $b \Elem A$ if
              $(n,b) \Elem H$ then $(n \NATplus \NATone, f(b)) \Elem H$.
              \begin{proof}
                Let $n \Elem \Nat$ and $b \Elem A$.
                Assume $(n,b) \Elem H$.
                Then $(n \NATplus \NATone, f(b)) \Elem \SETintersectover \Phi$.
                We have $(n \NATplus \NATone, f(b)) \NotEq (\NATzero,y)$.
                Indeed $n \NATplus \NATone \NotEq \NATzero$.
                Hence $(n \NATplus \NATone, f(b)) \Elem H$.
              \end{proof}

              [prover vampire]
              Thus $H \Elem \Phi$ (by a).
              [prover eprover]
            End.

            Then $(\NATzero,y)$ is not contained in every member of $\Phi$.
            Contradiction.
          \end{case}
        End.
      End.
    \end{proof}

    (2) For all $n \Elem \Theta$ we have $n \NATplus \NATone \Elem \Theta$.
    \begin{proof}
      Let $n \Elem \Theta$.
      Then for all $x, y \Elem A$ if $(n, x), (n, y) \Elem \SETintersectover \Phi$ then
      $x \Eq y$.
      Consider a $b \Elem A$ such that $(n,b) \Elem \SETintersectover \Phi$.
      Then $(n \NATplus \NATone, f(b)) \Elem \SETintersectover \Phi$.

      Let us show that for all $x, y \Elem A$ if $(n \NATplus \NATone, x),
      (n \NATplus \NATone, y) \Elem \SETintersectover \Phi$ then $x \Eq f(b) \Eq y$.
        Let $x, y \Elem A$.
        Assume $(n \NATplus \NATone, x), (n \NATplus \NATone, y) \Elem \SETintersectover \Phi$.
        Suppose $x \NotEq f(b)$ or $y \NotEq f(b)$.

        \begin{case}{$x \NotEq f(b)$.}
          Take $H = (\SETintersectover \Phi) \SETdiff \SETsingleton{(n \NATplus \NATone,x)}$.

          (i) $H \Elem \SETpow(\Nat \SETprod A)$.

          (ii) $(\NATzero,a) \Elem H$.
          \begin{proof}
            $(\NATzero,a) \Elem \SETintersectover \Phi$.
            $(\NATzero,a) \NotElem \SETsingleton{(n \NATplus \NATone,x)}$.
            Indeed $(\NATzero,a) \NotEq (n \NATplus \NATone,x)$.
            Indeed $\NATzero \NotEq n \NATplus \NATone$.
          \end{proof}

          (iii) For all $m \Elem \Nat$ and all $z \Elem A$ if $(m,z) \Elem H$ then $(m \NATplus \NATone,f(z)) \Elem H$.
          \begin{proof}
            Let $m \Elem \Nat$ and $z \Elem A$.
            Assume $(m,z) \Elem H$.
            Then $(m,z) \Elem \SETintersectover \Phi$.
            Hence $(m \NATplus \NATone,f(z)) \Elem \SETintersectover \Phi$.
            $(m \NATplus \NATone,f(z)) \NotEq (n \NATplus \NATone,x)$.
            Indeed if $(m \NATplus \NATone,f(z)) \Eq (n \NATplus \NATone,x)$ then $m \Eq n$ and $f(z) \Eq x$ (by \sn{injectivity of successor function}).
            Thus $(m \NATplus \NATone,f(z)) \NotElem \SETsingleton{(n \NATplus \NATone,x)}$.
            Therefore $(m \NATplus \NATone,f(z)) \Elem H$.
          \end{proof}

          [prover vampire]
          Thus $H \Elem \Phi$ (by a, i, ii, iii).
          [prover eprover]
          Therefore every element of $\SETintersectover \Phi$ is contained in $H$.
          Consequently $(n \NATplus \NATone,x) \Elem H$.
          Contradiction.
        \end{case}

        \begin{case}{$y \NotEq f(b)$.}
          Take $H = (\SETintersectover \Phi) \SETdiff \SETsingleton{(n \NATplus \NATone,y)}$.

          (i) $H \Elem \SETpow(\Nat \SETprod A)$.

          (ii) $(\NATzero,a) \Elem H$.
          \begin{proof}
            $(\NATzero,a) \Elem \SETintersectover \Phi$.
            $(\NATzero,a) \NotElem \SETsingleton{(n \NATplus \NATone,y)}$.
            Indeed $(\NATzero,a) \NotEq (n \NATplus \NATone,y)$.
            Indeed $\NATzero \NotEq n \NATplus \NATone$.
          \end{proof}

          (iii) For all $m \Elem \Nat$ and all $z \Elem A$ if $(m,z) \Elem H$ then $(m \NATplus \NATone,f(z)) \Elem H$.
          \begin{proof}
            Let $m \Elem \Nat$ and $z \Elem A$.
            Assume $(m,z) \Elem H$.
            Then $(m,z) \Elem \SETintersectover \Phi$.
            Hence $(m \NATplus \NATone,f(z)) \Elem \SETintersectover \Phi$.
            $(m \NATplus \NATone,f(z)) \NotEq (n \NATplus \NATone,y)$.
            Indeed if $(m \NATplus \NATone,f(z)) \Eq (n \NATplus \NATone,y)$ then $m \Eq n$ and $f(z) \Eq y$ (by \sn{injectivity of successor function}).
            Thus $(m \NATplus \NATone,f(z)) \NotElem \SETsingleton{(n \NATplus \NATone,y)}$.
            Therefore $(m \NATplus \NATone,f(z)) \Elem H$.
          \end{proof}

          [prover vampire]
          Thus $H \Elem \Phi$ (by a, i, ii, iii).
          [prover eprover]
          Therefore every element of $\SETintersectover \Phi$ is contained in $H$.
          Consequently $(n \NATplus \NATone,y) \Elem H$.
          Contradiction.
        \end{case}

        Hence it is wrong that $x \NotEq f(b)$ or $y \NotEq f(b)$.
        Consequently $x \Eq f(b) \Eq y$.
      End.

      Therefore $n \NATplus \NATone \Elem \Theta$ (by a).
    \end{proof}

    Consequently $n \Elem \Theta$ for every $n \Elem \Nat$ (by \sr{induction I}{induction}).
  \end{proof}

  Define $\varphi(n) =$ ``choose $x \Elem A$ such that $(n, x) \Elem
  \SETintersectover \Phi$ in $x$'' for $n \in \Nat$.

  (1) Then $\varphi$ is a map from $\Nat$ to $A$ and we have
  $\varphi(\NATzero) \Eq a$.

  (2) For all $n \Elem \Nat$ we have $\varphi(n \NATplus \NATone) \Eq
  f(\varphi(n))$.
  \begin{proof}
    Let $n \Elem \Nat$.
    Take $x \Elem A$ such that $\varphi(n) \Eq x$.
    Then $(n, x) \Elem \SETintersectover \Phi$.
    Hence $(n \NATplus \NATone, f(\varphi(n))) \Eq (n \NATplus \NATone, f(x)) \Elem \SETintersectover \Phi$.
    Thus $\varphi(n \NATplus \NATone) \Eq f(\varphi(n))$ (by a).
  \end{proof}
\end{proof}

\symdecl*{Dedekind Recursion Uniqueness}

\begin{theorem}[forthel,title=Dedekind's Recursion Theorem: Uniqueness,name=Dedekind Recursion Uniqueness]
  Let $A$ be a set and $a \Elem A$ and $f \FUNfromto{A}{A}$.
  Let $\varphi, \varphi' \FUNfromto{\Nat}{A}$.
  Assume that $\varphi$ and $\varphi'$ are recursively defined by $a$ and
  $f$.
  Then $\varphi \Eq \varphi'$.
\end{theorem}
\begin{proof}[forthel]
  Define $\Phi = \SClass{n}{\Nat}{\varphi(n) \Eq \varphi'(n)}$.

  (1) $\Phi$ contains $\NATzero$.
  Indeed $\varphi(\NATzero) \Eq a \Eq \varphi'(\NATzero)$.

  (2) For all $n \Elem \Phi$ we have $n \NATplus \NATone \Elem \Phi$.
  \begin{proof}
    Let $n \Elem \Phi$.
    Then $\varphi(n) \Eq \varphi'(n)$.
    Hence $\varphi(n \NATplus \NATone)
      \Eq f(\varphi(n))
      \Eq f(\varphi'(n))
      \Eq \varphi'(n \NATplus \NATone)$.
    \end{proof}

  Thus $\Phi$ contains every natural number (by \sr{induction I}{induction}).
  Consequently $\varphi(n) \Eq \varphi'(n)$ for each $n \Elem \Nat$.
\end{proof}
\end{smodule}
\end{document}
