\documentclass{stex}
\libusepackage{naproche}
\libinput{preamble}
\begin{document}
\begin{smodule}{euclid-division-theorem.ftl}
\importmodule[libraries/arithmetics]{multiplication-and-ordering.ftl}
\importmodule[libraries/arithmetics]{subtraction.ftl}

\symdecl*{Euclid Division Existence}

\begin{theorem}[forthel,title=Euclid's Division Theorem: Existence,name=Euclid Division Existence]
  Let $n, m$ be natural numbers such that $m \NotEq \NATzero$.
  Then there exist natural numbers $q, r$ such that
  \[n \Eq (m \NATmul q) \NATplus r\]
  and $r \NATless m$.
\end{theorem}
\begin{proof}[forthel]
  (a) Define $\Phi = \SClass{n'}{\Nat}{\text{ there exist natural numbers }q, r\text{ such that }r \NATless m\text{ and }n' \Eq (m \NATmul q) \NATplus r}$.

  (1) $\Phi$ contains $\NATzero$.
  \begin{proof}
    Take $q \Eq \NATzero$ and $r = \NATzero$.
    Then $r \NATless m$ and $\NATzero \Eq (m \NATmul q) \NATplus r$.
    Hence $\NATzero \Elem \Phi$.
  \end{proof}

  (2) For all $n' \Elem \Phi$ we have $n' \NATplus \NATone \Elem \Phi$.
  \begin{proof}
    Let $n' \Elem \Phi$.

    Let us show that there exist natural numbers $q, r$ such that $r \NATless m$ and $n' \NATplus \NATone \Eq (m \NATmul q) \NATplus r$.
      Take natural numbers $q', r'$ such that $r' \NATless m$ and $n' \Eq (m \NATmul q') \NATplus r'$ (by a).
      We have $r' \NATplus \NATone \NATless m$ or $r' \NATplus \NATone \Eq m$.

      \begin{case}{$r' \NATplus \NATone \NATless m$.}
        Take $q \Eq q' \NATplus \NATzero$ and $r = r' \NATplus \NATone$. %!
        Then $r \NATless m$ and $n' \NATplus \NATone
          \Eq ((q' \NATmul m) \NATplus r') \NATplus \NATone
          \Eq (q' \NATmul m) \NATplus (r' \NATplus \NATone)
          \Eq (q \NATmul m) \NATplus r$.
      \end{case}

      \begin{case}{$r' \NATplus \NATone \Eq m$.}
        Take  $q = q' \NATplus \NATone$ and $r = \NATzero$.
        Then $r \NATless m$ and
        $n' \NATplus \NATone
          \Eq ((q' \NATmul m) \NATplus r') \NATplus \NATone
          \Eq (q' \NATmul m) \NATplus (r' \NATplus \NATone)
          \Eq (q' \NATmul m) \NATplus m
          \Eq (q' \NATmul m) \NATplus (\NATone \NATmul m)
          \Eq (q' \NATplus \NATone) \NATmul m
          \Eq (q \NATmul m) \NATplus r$.
      \end{case}
    End.

    Hence $n' \NATplus \NATone \Elem \Phi$.
  \end{proof}

  Then $\Phi$ contains every natural number (by \sr{induction I}{induction}).
  Thus there exist natural numbers $q, r$ such that $n \Eq (m \NATmul q) \NATplus r$ and $r \NATless m$ (by a).
\end{proof}

\symdecl*{Euclid Division Uniqueness}

\begin{theorem}[forthel,title=Euclid's Division Theorem: Uniqueness,name=Euclid Division Uniqueness]
  Let $n, m$ be natural numbers such that $m \NotEq \NATzero$.
  Let $q, r$ be natural numbers such that
  \[n \Eq (m \NATmul q) \NATplus r\]
  and $r \NATless m$.
  Let $q', r'$ be natural numbers such that
  \[n \Eq (m \NATmul q') \NATplus r'\]
  and $r' \NATless m$.
  Then $q \Eq q'$ and $r \Eq r'$.
\end{theorem}
\begin{proof}[forthel]
  We have $(m \NATmul q) \NATplus r \Eq (m \NATmul q') \NATplus r'$.

  \begin{case}{$q \NATgeq q'$ and $r \NATgeq r'$.}
    (1) $((m \NATmul q) \NATplus r) \NATsub r' \Eq (m \NATmul q) \NATplus (r \NATsub r')$ (by \sn{associativity of addition and subtraction}).
    (2) $((m \NATmul q') \NATplus r') \NATsub r'
      \Eq (m \NATmul q') \NATplus (r' \NATsub r')
      \Eq m \NATmul q'$.
    Hence $(m \NATmul q) \NATplus (r \NATsub r') \Eq m \NATmul q'$.
    Thus $((m \NATmul q) \NATsub (m \NATmul q')) \NATplus (r \NATsub r') \Eq \NATzero$.
    Consequently $(m \NATmul q) \NATsub (m \NATmul q') \Eq \NATzero$ and $r \NATsub r' \Eq \NATzero$.
    If $(m \NATmul q) \NATsub (m \NATmul q') \Eq \NATzero$ then $q \NATsub q' \Eq \NATzero$.
    Therefore $q \NATsub q' \Eq \NATzero$ and $r \NATsub r' \Eq \NATzero$.
    Thus we have $q \Eq q'$ and $r \Eq r'$.
  \end{case}

  \begin{case}{$q \NATgeq q'$ and $r \NATless r'$.}
    Take $q'' = q \NATsub q'$ and $r'' = r' \NATsub r$.
    Then $(m \NATmul (q' \NATplus q'')) \NATplus r \Eq (m \NATmul q') \NATplus (r \NATplus r'')$.
    We have $(m \NATmul q') \NATplus (r \NATplus r'')
      \Eq (m \NATmul q') \NATplus (r'' \NATplus r)
      \Eq ((m \NATmul q') \NATplus r'') \NATplus r$.
    Hence $(m \NATmul (q' \NATplus q'')) \NATplus r \Eq ((m \NATmul q') \NATplus r'') \NATplus r$.
    Thus $m \NATmul (q' \NATplus q'') \Eq (m \NATmul q') \NATplus r''$ (by \sn{right-cancellability of addition}).
    We have $m \NATmul (q' \NATplus q'') \Eq (m \NATmul q') \NATplus (m \NATmul q'')$.
    Hence $(m \NATmul q') \NATplus (m \NATmul q'') \Eq (m \NATmul q') \NATplus r''$.
    Thus $m \NATmul q'' \Eq r''$.
    Then we have $m \NATmul q'' \NATless m \NATmul \NATone$.
    Indeed $m \NATmul q''
      \Eq r''
      \NATleq r'
      \NATless m
      \Eq m \NATmul \NATone$.
    Therefore $q'' \NATless \NATone$ (by \sn{preservation of ordering under left-multiplication}).
    Consequently $q \NATsub q' \Eq q'' \Eq \NATzero$.
    Hence $q \Eq q'$.
    Thus $(m \NATmul q) \NATplus r \Eq (m \NATmul q) \NATplus r'$.
    Therefore $r \Eq r'$.
  \end{case}

  \begin{case}{$q \NATless q'$ and $r \NATgeq r'$.}
    Take $q'' = q' \NATsub q$ and $r'' = r \NATsub r'$.
    Then $(m \NATmul q) \NATplus (r' \NATplus r'') \Eq (m \NATmul (q \NATplus q'')) \NATplus r'$.
    We have $(m \NATmul q) \NATplus (r' \NATplus r'')
      \Eq (m \NATmul q) \NATplus (r'' \NATplus r')
      \Eq ((m \NATmul q) \NATplus r'') \NATplus r'$.
    Hence $((m \NATmul q) \NATplus r'') \NATplus r' \Eq (m \NATmul (q \NATplus q'')) \NATplus r'$.
    Thus $(m \NATmul q) \NATplus r'' \Eq m \NATmul (q \NATplus q'')$ (by \sn{right-cancellability of addition}).
    We have $m \NATmul (q \NATplus q'') \Eq (m \NATmul q) \NATplus (m \NATmul q'')$.
    Hence $(m \NATmul q) \NATplus r'' \Eq (m \NATmul q) \NATplus (m \NATmul q'')$.
    Thus $r'' \Eq m \NATmul q''$.
    Then we have $m \NATmul q'' \NATless m \NATmul \NATone$.
    Indeed $m \NATmul q''
      \Eq r''
      \NATleq r
      \NATless m
      \Eq m \NATmul \NATone$.
    Therefore $q'' \NATless \NATone$ (by \sn{preservation of ordering under left-multiplication}).
    Consequently $q' \NATsub q \Eq q'' \Eq \NATzero$.
    Hence $q' \Eq q$.
    Thus $(m \NATmul q) \NATplus r \Eq (m \NATmul q) \NATplus r'$.
    Therefore $r \Eq r'$.
  \end{case}

  \begin{case}{$q \NATless q'$ and $r \NATless r'$.}
    (1) $((m \NATmul q') \NATplus r') \NATsub r \Eq (m \NATmul q') \NATplus (r' \NATsub r)$ (by \sn{associativity of addition and subtraction}).
    (2) $((m \NATmul q) \NATplus r) \NATsub r
      \Eq (m \NATmul q) \NATplus (r \NATsub r)
      \Eq m \NATmul q$.
    Hence $(m \NATmul q') \NATplus (r' \NATsub r) \Eq m \NATmul q$.
    Thus $((m \NATmul q') \NATsub (m \NATmul q)) \NATplus (r' \NATsub r)
      \Eq ((m \NATmul q') \NATplus (r' \NATsub r)) \NATsub (m \NATmul q)
      \Eq \NATzero$.
    Consequently $(m \NATmul q') \NATsub (m \NATmul q) \Eq \NATzero$ and $r' \NATsub r \Eq \NATzero$.
    If $(m \NATmul q') \NATsub (m \NATmul q) \Eq \NATzero$ then $q' \NATsub q \Eq \NATzero$.
    Therefore $q' \NATsub q \Eq \NATzero$ and $r' \NATsub r \Eq \NATzero$.
    Thus we have $q' \Eq q$ and $r' \Eq r$.
  \end{case}
\end{proof}
\end{smodule}
\end{document}
