\documentclass{stex}
\libusepackage{naproche}
\libinput{preamble}
\begin{document}
\begin{smodule}{zfc.ftl}
\importmodule[libraries/set-theory]{axioms?set-existence.ftl}
\importmodule[libraries/set-theory]{axioms?separation.ftl}
\importmodule[libraries/set-theory]{axioms?pairing.ftl}
\importmodule[libraries/set-theory]{axioms?union.ftl}
\importmodule[libraries/set-theory]{axioms?powerset.ftl}
\importmodule[libraries/set-theory]{axioms?infinity.ftl}
\importmodule[libraries/set-theory]{axioms?replacement.ftl}
\importmodule[libraries/set-theory]{axioms?foundation.ftl}
\importmodule[libraries/set-theory]{axioms?choice.ftl}
\importmodule[libraries/foundations]{pairs-and-products.ftl}
\importmodule[libraries/foundations]{invertible-maps.ftl}

\begin{proposition}[forthel]
  $\SETempty$ is a set.
\end{proposition}
\begin{proof}[forthel]
  Take a set $x$ (by \sn{Set Existence Axiom}).
  Define $A \DefEq \SClass{y}{x}{y \NotEq y}$.
  Then $A$ is a set (by \sn{Separation Axiom}).
  We have $A \Eq \SETempty$.
  Hence $\SETempty$ is a set.
\end{proof}

\begin{proposition}[forthel]
  Let $x, y$ be sets.
  Then $x \SETunion y$ is a set.
\end{proposition}
\begin{proof}[forthel]
  Take $X \Eq \SETpair{x}{y}$.
  Then $X$ is a set.
  Hence $\SETunionover X$ is a set (by \sn{Union Axiom}).
  Indeed $X$ is a system of sets.
  We have $x \SETunion y \Eq \SETunionover X$.
  Thus $x \SETunion y$ is a set.
\end{proof}

\begin{proposition}[forthel]
  Let $x, y$ be sets.
  Then $x \SETintersect y$ is a set.
\end{proposition}
\begin{proof}[forthel]
  We have $x \SETintersect y \SETinclude x$.
  Hence $x \SETintersect y$ is a set (by \sn{Separation Axiom}).
\end{proof}

\begin{proposition}[forthel]
  Let $x, y$ be sets.
  Then $x \SETdiff y$ is a set.
\end{proposition}
\begin{proof}[forthel]
  We have $x \SETdiff y \SETinclude x$.
  Hence $x \SETdiff y$ is a set (by \sn{Separation Axiom}).
\end{proof}

\begin{proposition}[forthel]
  Let $x, y$ be sets.
  Then $x \SETprod y$ is a set.
\end{proposition}
\begin{proof}[forthel]
  $\SETsingleton{a}$ and $\SETpair{a}{b}$ are sets for each $a \Elem x$ and each $b \Elem y$.
  Define $P \DefEq \CClass{\SETpair{\SETsingleton{a}}{\SETpair{a}{b}}}{a \Elem x\text{ and }b \Elem y}$.

  (1) $P$ is a set.
  \begin{proof}
    Let us show that $P \SETinclude \SETpow(\SETpow(x \SETunion y))$.
      Let $p \Elem P$.
      Consider $a \Elem x$ and $b \Elem y$ such that $p \Eq \SETpair{\SETsingleton{a}}{\SETpair{a}{b}}$.
      Then $a, b \Elem x \SETunion y$.
      Hence $\SETsingleton{a}, \SETpair{a}{b} \Elem \SETpow(x \SETunion y)$.
      Thus $\SETpair{\SETsingleton{a}}{\SETpair{a}{b}} \Elem \SETpow(\SETpow(x \SETunion y))$.
    End.

    $x \SETunion y$ is a set.
    Consequently $\SETpow(\SETpow(x \SETunion y))$ is a set (by \sn{Powerset Axiom}).
    Therefore $P$ is a set (by \sn{Separation Axiom}).
  \end{proof}

  Define $l(p) \DefEq$ ``choose $a \Elem x$, choose $b \Elem y$ such that $p \Eq \SETpair{\SETsingleton{a}}{\SETpair{a}{b}}$ in $a$'' for $p \Elem P$.
  Define $r(p) \DefEq$ ``choose $a \Elem x$, choose $b \Elem y$ such that $p \Eq \SETpair{\SETsingleton{a}}{\SETpair{a}{b}}$ in $b$'' for $p \Elem P$.

  Define $f(p) \DefEq (l(p), r(p))$ for $p \Elem P$.

  Let us show that for any objects $u, u', v, v'$ if
  $\SETpair{\SETsingleton{u}}{\SETpair{u}{v}} \Eq \SETpair{\SETsingleton{u'}}{\SETpair{u'}{v'}}$ then $u \Eq u'$ and $v \Eq v'$.
    Let $u, u', v, v'$ be objects.
    Assume $\SETpair{\SETsingleton{u}}{\SETpair{u}{v}} \Eq \SETpair{\SETsingleton{u'}}{\SETpair{u'}{v'}}$.
    Then ($\SETsingleton{u} \Eq \SETsingleton{u'}$ or $\SETsingleton{u} \Eq \SETpair{u'}{v'}$) and ($\SETpair{u}{v} \Eq \SETsingleton{u'}$ or $\SETpair{u}{v} \Eq \SETpair{u'}{v'}$).
    Thus ($\SETsingleton{u} \Eq \SETsingleton{u'}$ and ($\SETpair{u}{v} \Eq \SETsingleton{u'}$ or $\SETpair{u}{v} \Eq \SETpair{u'}{v'}$)) or ($\SETsingleton{u} \Eq \SETpair{u'}{v'}$ and ($\SETpair{u}{v} \Eq \SETsingleton{u'}$ or $\SETpair{u}{v} \Eq \SETpair{u'}{v'}$)).

    \begin{case}{$\SETsingleton{u} \Eq \SETsingleton{u'}$ and ($\SETpair{u}{v} \Eq \SETsingleton{u'}$ or $\SETpair{u}{v} \Eq \SETpair{u'}{v'}$).}
      We have $\SETsingleton{u} \Eq \SETsingleton{u'}$.
      Hence $u \Eq u'$.

      \begin{case}{$\SETpair{u}{v} \Eq \SETsingleton{u'}$.}
        Then $u \Eq u'\Eq v$.
        Hence $\SETpair{\SETsingleton{u}}{\SETpair{u}{u}} \Eq \SETpair{\SETsingleton{u}}{\SETpair{u}{v'}}$ (by 1).
        Thus $\SETsingleton{\SETsingleton{u}} \Eq \SETpair{\SETsingleton{u}}{\SETpair{u}{v'}}$.
        Therefore $\SETsingleton{u} \Eq \SETpair{u}{v'}$.
        Consequently $v' \Eq u \Eq v$.
      \end{case}

      \begin{case}{$\SETpair{u}{v} \Eq \SETpair{u'}{v'}$.}
        Then $\SETpair{u}{v} \Eq \SETpair{u}{v'}$.
        Hence $v \Eq v'$.
      \end{case}
    \end{case}

    \begin{case}{$\SETsingleton{u} \Eq \SETpair{u'}{v'}$ and ($\SETpair{u}{v} \Eq \SETsingleton{u'}$ or $\SETpair{u}{v} \Eq \SETpair{u'}{v'}$).}
      We have $\SETsingleton{u} \Eq \SETpair{u'}{v'}$.
      Hence $u \Eq u'$.

      \begin{case}{$\SETpair{u}{v} \Eq \SETsingleton{u'}$.}
        Then $u \Eq v \Eq u'$.
        Hence $v \Eq v'$.
      \end{case}

      \begin{case}{$\SETpair{u}{v} \Eq \SETpair{u'}{v'}$.}
        Then $\SETpair{u}{v} \Eq \SETpair{u}{v'}$.
        Hence $v \Eq v'$.
      \end{case}
    \end{case}
  End.

  $\SETpair{\SETsingleton{a}}{\SETpair{a}{b}} \Elem \Dom(f)$ for any $a \Elem x$ and any $b \Elem y$. % Needed for ontological checking
  \begin{proof}
    Let $a \Elem x$ and $b \Elem y$.
    Then $\SETpair{\SETsingleton{a}}{\SETpair{a}{b}} \Elem P$.
  \end{proof}

  Let us show that for any $a \Elem x$ and any $b \Elem y$ we have $f(\SETpair{\SETsingleton{a}}{\SETpair{a}{b}}) \Eq (a,b)$.
    Let $a \Elem x$ and $b \Elem y$.
    Take $p \Eq \SETpair{\SETsingleton{a}}{\SETpair{a}{b}}$.
    Then $p$ is a set.
    Then we can choose $a' \Elem x$ and $b' \Elem y$ such that $p \Eq \SETpair{\SETsingleton{a'}}{\SETpair{a'}{b'}}$ and $l(p) \Eq a'$.
    Then $a \Eq a'$ and $b \Eq b'$.
    Hence $l(p) \Eq a$.
    Choose $a'' \Elem x$ and $b'' \Elem y$ such that $p \Eq \SETpair{\SETsingleton{a''}}{\SETpair{a''}{b''}}$ and $r(p) \Eq b''$.
    Then $a \Eq a''$ and $b \Eq b''$.
    Thus $r(p) \Eq b$.
    Therefore $f(p) \Eq (a,b)$.
  End.

  (2) $x \SETprod y \Eq \FUNim{f}{P}$.
  \begin{proof}
    For all $p \Elem P$ we have $l(p) \Elem x$ and $r(p) \Elem y$.
    Hence $f(p) \Elem x \SETprod y$ for all $p \Elem P$.
    Therefore $\FUNim{f}{P} \SETinclude x \SETprod y$.

    Let us show that $x \SETprod y \SETinclude \FUNim{f}{P}$.
      Let $z \Elem x \SETprod y$.
      Take $a \Elem x$ and $b \Elem y$ such that $z \Eq (a,b)$.
      Then $(a,b) \Eq f(\SETpair{\SETsingleton{a}}{\SETpair{a}{b}})$.
      Hence there exists a $p \Elem P$ such that $(a,b) \Eq f(p)$.
      Thus $(a,b) \Elem \FUNim{f}{P}$.
    End.

    Consequently $x \SETprod y \Eq \FUNim{f}{P}$.
  \end{proof}

  Thus $x \SETprod y$ is the image of some set under some map.
  Therefore $x \SETprod y$ is a set (by \sn{Replacement Axiom}).
\end{proof}

\begin{proposition}[forthel]
  Let $X$ be a nonempty system of sets.
  Then $\SETintersectover X$ is a set.
\end{proposition}
\begin{proof}[forthel]
  Take an element $x$ of $X$.
  Then $\SETintersectover X \SETinclude x$.
  Hence $\SETintersectover X$ is a set (by \sn{Separation Axiom}).
\end{proof}

\begin{proposition}[forthel]
  Let $f$ be a map such that $\Dom(f)$ is a set.
  Then $\FUNrange(f)$ is a set.
\end{proposition}
\begin{proof}[forthel]
  $\FUNrange(f) \Eq \FUNim{f}{\Dom(f)}$ and $\FUNim{f}{\Dom(f)}$ is a set.
  Hence $\FUNrange(f)$ is a set (by \sn{Replacement Axiom}).
\end{proof}

\begin{proposition}[forthel]
  Let $A$ be a class and $x$ be a set.
  Assume that there exists an injective map from $A$ to $x$.
  Then $A$ is a set.
\end{proposition}
\begin{proof}[forthel]
  Consider an injective map $f$ from $A$ to $x$.
  Then $\FUNinv{f}$ is a bijection between $\FUNrange(f)$ and $A$.
  $\FUNrange(f)$ is a set and $A$ is the image of $\FUNrange(f)$ under $\FUNinv{f}$.
  Indeed $\FUNrange(f) \SETinclude x$.
  Thus $A$ is a set (by \sn{Replacement Axiom}).
\end{proof}

\begin{proposition}[forthel]
  There exist no sets $x, y$ such that $x \Elem y$ and $y \Elem x$.
\end{proposition}
\begin{proof}[forthel]
  Assume the contrary.
  Take sets $x,y$ such that $x \Elem y$ and $y \Elem x$.
  Consider an element $z$ of $\SETpair{x}{y}$ such that $\SETpair{x}{y}$ and $z$ are disjoint (by \sn{Foundation Axiom}).
  Indeed $\SETpair{x}{y}$ is a nonempty system of sets.
  Then we have $z \Eq x$ or $z \Eq y$.

  \begin{case}{$z \Eq x$.}
    Then $x$ and $\SETpair{x}{y}$ are disjoint.
    Hence $y \NotElem x$.
    Contradiction.
  \end{case}

  \begin{case}{$z \Eq y$.}
    Then $y$ and $\SETpair{x}{y}$ are disjoint.
    Hence $x \NotElem y$.
    Contradiction.
  \end{case}
\end{proof}

\begin{corollary}[forthel]
  Let $x$ be a set.
  Then $x \NotElem x$.
\end{corollary}

\begin{proposition}[forthel]
  Let $f, g$ be functions.
  Assume that $\Dom(f) \Eq \Dom(g)$ and $f(a) \Eq g(a)$ for all $a \Elem \Dom(f)$.
  Then $f \Eq g$.
\end{proposition}

\begin{proposition}[forthel]
  Let $x, y$ be sets.
  Then $\FUNfunspace{x}{y}$ is a set.
\end{proposition}
\begin{proof}[forthel]
  Define $R \DefEq \SClass{F}{\SETpow(x \SETprod y)}{\text{ (for all }a \Elem x\text{ there exists a }b \Elem y\text{ such that }(a,b) \Elem F\text{) and for all }a \Elem x\text{ and all }b, b' \Elem y\text{ such that }(a,b), (a,b') \Elem F\text{ we have }b \Eq b'}$.

  [prover vampire]
  Every element of $R$ is a set. % Needed for ontological checking
  Define $h(F) \DefEq \Map{a}{x}$ ``choose $b \Elem y$ such that $(a,b) \Elem F$ in $b$'' for $F \Elem R$.
  [prover eprover]

  Let us show that $\FUNfunspace{x}{y} \SETinclude \FUNrange(h)$.
    Let $f \Elem \FUNfunspace{x}{y}$.
    Define $F \DefEq \CClass{(a,f(a))}{a \Elem x}$.

    Then $F \Elem R$.
    \begin{proof}
      Define $g(a) \DefEq (a,f(a))$ for $a \Elem x$.
      Then $F \Eq \FUNrange(g)$.
      Hence $F$ is a set.
      Thus $F \Elem \SETpow(x \SETprod y)$.
      Indeed $F \SETinclude x \SETprod y$.

      (1) For all $a \Elem x$ there exists a $b \Elem y$ such that $(a,b) \Elem F$.

      (2) For all $a \Elem x$ and all $b, b' \Elem y$ such that $(a,b),
      (a,b') \Elem F$ we have $b \Eq b'$.
      \begin{proof}
        Let $a \Elem x$ and $b, b' \Elem y$.
        Assume $(a,b), (a,b') \Elem F$.
        Take $c, c' \Elem F$ such that $c \Eq (a,b)$ and $c' \Eq (a,b')$.
        Take $d, d' \Elem x$ such that $c \Eq (d,f(d))$ and $c' \Eq (d',f(d'))$.
        Then $a \Eq d$ and $b \Eq f(d)$ and $a \Eq d'$ and $b' \Eq f(d)$.
        Hence $b \Eq b'$.
      \end{proof}

      [prover vampire]
      Hence the thesis.
    \end{proof}

    $\Dom(f) \Eq \Dom(h(F))$ and for each $a \Elem \Dom(f)$ we have $h(F)(a) \Eq f(a)$.
    Hence $f \Eq h(F)$.
    Thus $f \Elem \FUNrange(h)$.
  End.

  Therefore $\FUNfunspace{x}{y}$ is a set.
  Indeed $R$ is a set.
\end{proof}
\end{smodule}
\end{document}
