\documentclass{stex}
\libusepackage{naproche}
\libinput{preamble}
\begin{document}
\begin{smodule}{injections-surjections-bijections.ftl}
\importmodule[libraries/foundations]{maps.ftl}
\symdef{FUNfromonto}[args=2]{\mathbin{\comp:}#1\mathbin{\comp\twoheadrightarrow}#2}
\symdef{FUNfrominto}[args=2]{\mathbin{\comp:}#1\mathbin{\comp\hookrightarrow}#2}
\symdecl*{surjective}
\symdecl*{injective}
\symdecl*{bijection}
\symdecl*{permutation}

\begin{sfragment}{Surjective Maps}
  \begin{definition}[forthel,for=surjective]
    Let $f$ be a map and $B$ be a class.
    $f$ is \emph{surjective onto $B$} iff $\FUNrange(f) \Eq B$.
    Let $f$ \emph{surjects onto $B$} stand for $f$ is surjective onto $B$.
    Let a \emph{surjective map onto $B$} stand for a map that is surjective onto $B$.
  \end{definition}

  \begin{definition}[forthel,for={surjective,FUNfromonto}]
    Let $A, B$ be classes.
    A \emph{surjective map from $A$ to $B$} is a map of $A$ that is surjective onto $B$.
    Let a \emph{surjective map from $A$ onto $B$} stand for a surjective map from $A$ to $B$.
    Let $\emph{f \FUNfromonto{A}{B}}$ stand for $f$ is a surjective map from $A$ onto $B$.
  \end{definition}

  \begin{proposition}[forthel]
    Let $B$ be a class and $f$ be a map to $B$.
    $f$ is surjective onto $B$ iff every element of $B$ is a value of $f$.
  \end{proposition}
  \begin{proof}[forthel]
    \begin{case}{$f$ is surjective onto $B$.}
      Then $B \Eq \FUNrange(f)$.
      Let $b$ be an element of $B$.
      Then $b \Elem \FUNrange(f)$.
      Hence $b$ is a value of $f$.
    \end{case}

    \begin{case}{every element of $B$ is a value of $f$.}
      Let us show that $B \SETinclude \FUNrange(f)$.
        Let $b \Elem B$.
        Then $b$ is a value of $f$.
        Hence $b \Elem \FUNrange(f)$.
      End.

      Let us show that $\FUNrange(f) \SETinclude B$.
        Let $b \Elem \FUNrange(f)$.
        Then $b$ is a value of $f$.
        Hence $b \Elem B$.
      End.
    \end{case}
  \end{proof}
\end{sfragment}

\begin{sfragment}{Injective Maps}
  \begin{definition}[forthel,for={injective,FUNfrominto}]
    Let $f$ be a map.
    $f$ is \emph{injective} iff for all $a, a' \Elem \Dom(f)$ if $f(a) \Eq f(a')$ then $a \Eq a'$.
    Let $\emph{f \FUNfrominto{A}{B}}$ stand for $f$ is an injective map from $A$ to $B$.
  \end{definition}
\end{sfragment}

\begin{sfragment}{Bijective Maps}
  \begin{definition}[forthel,for=bijection]
    Let $A, B$ be classes.
    A \emph{bijection between $A$ and $B$} is an injective map from $A$ to $B$ that is surjective onto $B$.
    Let a \emph{bijection from $A$ to $B$} stand for a bijection between $A$ and $B$.
  \end{definition}

  \begin{proposition}[forthel]
    Let $A, B$ be classes and $f \FUNfrominto{A}{B}$.
    Then $f$ is a bijection between $A$ and $\FUNrange(f)$.
  \end{proposition}
  \begin{proof}[forthel]
    $f$ is injective and surjects onto $\FUNrange(f)$.
    Hence $f$ is a bijection between $A$ and $\FUNrange(f)$.
  \end{proof}

  \begin{definition}[forthel,for=permutation]
    Let $A$ be a class.
    A \emph{permutation of $A$} is a bijection between $A$ and $A$.
  \end{definition}
\end{sfragment}

\begin{sfragment}{Basic Properties}
  \begin{proposition}[forthel]
    Let $A$ be a class.
    Then $\FUNid{A}$ is a permutation of $A$.
  \end{proposition}
  \begin{proof}[forthel]
    (1) $\FUNid{A}$ is a map on $A$.

    (2) $\FUNid{A}$ is surjective onto $A$.
    \begin{proof}
      Let $a \Elem A$.
      Then $a \Eq \FUNid{A}(a)$.
      Hence $a \Elem \FUNrange(\FUNid{A})$.
    \end{proof}

    (3) $\FUNid{A}$ is injective.
    \begin{proof}
      Let $a, a' \Elem A$.
      Assume $\FUNid{A}(a) \Eq \FUNid{A}(a')$.
      Then $a \Eq a'$.
    \end{proof}
  \end{proof}

  \symdecl*{surjectivity of composition of surjections}

  \begin{proposition}[forthel,name=surjectivity of composition of surjections]
    Let $A, B, C$ be classes and $f \FUNfromonto{A}{B}$ and $g \FUNfromonto{B}{C}$.
    Then $g \FUNcomp f$ is a surjective map from $A$ onto $C$.
  \end{proposition}
  \begin{proof}[forthel]
    $g \FUNcomp f$ is a map of $A$.

    Let us show that $g \FUNcomp f$ is surjective onto $C$.
      Let $c \Elem C$.
      Take $b \Elem B$ such that $c \Eq g(b)$.
      Take $a \Elem A$ such that $b \Eq f(a)$.
      Then $c \Eq g(f(a)) \Eq (g \FUNcomp f)(a)$.
    End.
  \end{proof}

  \symdecl*{injectivity of composition of injections}

  \begin{proposition}[forthel,name=injectivity of composition of injections]
    Let $A, B, C$ be classes and $f \FUNfrominto{A}{B}$ and $g \FUNfrominto{B}{C}$.
    Then $g \FUNcomp f$ is an injective map from $A$ to $C$.
  \end{proposition}
  \begin{proof}[forthel]
    $g \FUNcomp f$ is a map of $A$.

    Let us show that $g \FUNcomp f$ is injective.
      Let $a, a' \Elem A$.
      Assume $(g \FUNcomp f)(a) \Eq (g \FUNcomp f)(a')$.
      Then $g(f(a)) \Eq g(f(a'))$.
      Hence $f(a) \Eq f(a')$.
      Indeed $f(a), f(a') \Elem B$.
      Thus $a \Eq a'$.
    End.
  \end{proof}

  \symdecl*{bijectivity of composition of bijections}

  \begin{corollary}[forthel,name=bijectivity of composition of bijections]
    Let $A, B, C$ be classes.
    Let $f$ be a bijection between $A$ and $B$ and $g$ be a bijection between $B$ and $C$.
    Then $g \FUNcomp f$ is a bijection between $A$ and $C$.
  \end{corollary}
  \begin{proof}[forthel]
    $g \FUNcomp f$ is an injective map from $A$ to $C$ (by \sn{injectivity of composition of injections}).
    $g \FUNcomp f$ is a surjective map from $A$ onto $C$ (by \sn{surjectivity of composition of surjections}).
  \end{proof}

  \begin{proposition}[forthel]
    Let $A, B$ be classes and $f \FUNfrominto{A}{B}$ and $X \SETinclude A$.
    Then $f \FUNrest X$ is injective.
  \end{proposition}
  \begin{proof}[forthel]
    Let $a, a' \Elem X$.
    Assume $(f \FUNrest X)(a) \Eq (f \FUNrest X)(a')$.
    Then $f(a) \Eq f(a')$.
    Hence $a \Eq a'$.
  \end{proof}

  \symdecl*{bijectivity of restriction of injection}
  
  \begin{proposition}[forthel,name=bijectivity of restriction of injection]
    Let $A, B$ be classes and $f \FUNfrominto{A}{B}$ and $X \SETinclude A$.
    Then $f \FUNrest X$ is a bijection between $X$ and $\FUNim{f}{X}$.
  \end{proposition}

  \begin{corollary}[forthel]
    Let $A, B$ be classes and $f \FUNfrominto{A}{B}$.
    Then $f$ is a bijection between $A$ and $\FUNim{f}{A}$.
  \end{corollary}
\end{sfragment}
\end{smodule}
\end{document}
