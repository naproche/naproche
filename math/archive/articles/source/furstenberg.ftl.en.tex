\documentclass{stex}
\libusepackage{naproche}
\libusepackage{copyright}
\libinput{preamble}

\title{Furstenberg's Proof of the Infinitude of Primes in \Naproche}
\author{Andrei Paskevich, Marcel Sch√ºtz}
\date{2025}

\begin{document}
\begin{smodule}{furstenberg.ftl}
\maketitle

\importmodule[libraries/arithmetics]{primes.ftl}
\importmodule[libraries/arithmetics]{nat-is-a-set.ftl}
\importmodule[libraries/set-theory]{zfc.ftl}
\importmodule[libraries/foundations]{closure-under-finite-unions.ftl}

\symdef{compl}[args=1]{#1^{\comp\complement}}
\symdef{ArithSeq}[args=2]{\comp{\mathrm{N}}_{#1\comp,#2}}
\symdef{Int}{\mathbb{Z}}
\symdef{PrimeSeq}{\mathrm{P}}
\symdecl*{open}
\symdecl*{system of open sets}
\symdecl*{closed}
\symdecl*{system of closed sets}
\symdecl*{Furstenberg}

\noindent This is a formalization of Furstenberg's topological proof of the
infinitude of primes \cite[p. 353]{Furstenberg1955}.

The central idea of Furstenberg's proof is to define a certain topology on
$\Nat$ from the properties of which we can deduce that the set of
primes is infinite.\footnote{Actually, Furstenberg's proof makes use of a
topology on $\Int$. But this topology can as well be restricted to
$\Nat$ without substantially changing the proof.}

\begin{forthel}
  Let $n, m, k$ denote natural numbers.
  Let $p, q$ denote nonzero natural numbers.

  \begin{definition}[for=compl]
    Let $A$ be a subset of $\Nat$.
    $\compl{A} \DefEq \Nat \SETdiff A$.
  \end{definition}

  Let the complement of $A$ stand for $\compl{A}$.

  \begin{lemma}
    The complement of any subset of $\Nat$ is a subset of $\Nat$.
  \end{lemma}
\end{forthel}

Towards a suitable topology on $\Nat$ let us define \textit{arithmetic
sequences} $\ArithSeq{n}{q}$ on $\Nat$.

\begin{forthel}
  \begin{definition}[for=ArithSeq]
    $\ArithSeq{n}{q} \DefEq \SClass{m}{\Nat}{\NATcong{m}{n}{q}}$.
  \end{definition}
\end{forthel}

This allows us to define the \textit{evenly spaced natural number
topology} on $\Nat$, whose open sets are defined as follows.

\begin{forthel}
  \begin{definition}[for=open]
    Let $U$ be a subset of $\Nat$.
    $U$ is open iff for any $n \Elem U$ there exists a $q$ such that
    $\ArithSeq{n}{q} \SETinclude U$.
  \end{definition}

  \begin{definition}[for=system of open sets]
    A system of open sets is a system of sets $S$ such that every element of
    $S$ is an open subset of $\Nat$.
  \end{definition}

  \begin{lemma}
    Every system of open sets is a set.
  \end{lemma}
  \begin{proof}
    Let $S$ be a system of open sets.
    Then $S \SETinclude \SETpow(\Nat)$.
    Hence $S$ is a set.
  \end{proof}
\end{forthel}

We can show that the open sets indeed form a topology on $\Nat$.

\begin{forthel}
  \begin{lemma}
    $\Nat$ and $\SETempty$ are open.
  \end{lemma}

  \begin{lemma}
    Let $U,V$ be open subsets of $\Nat$.
    Then $U \SETintersect V$ is open.
  \end{lemma}
  \begin{proof}
    Let $n \Elem U \SETintersect V$.
    Take a $q$ such that $\ArithSeq{n}{q} \SETinclude U$.
    Take a $p$ such that $\ArithSeq{n}{p} \SETinclude V$.
    Then $p \NATmul q \NotEq \NATzero$.

    Let us show that $\ArithSeq{n}{p \NATmul q} \SETinclude U \SETintersect V$.
      Let $m \Elem \ArithSeq{n}{p \NATmul q}$.
      We have\linebreak $\NATcong{m}{n}{p \NATmul q}$.
      Hence $\NATcong{m}{n}{p}$ and $\NATcong{m}{n}{q}$.
      Thus $m \Elem \ArithSeq{n}{p}$ and $m \Elem \ArithSeq{n}{q}$.
      Therefore $m \Elem U$ and $m \Elem V$.
      Consequently $m \Elem U \SETintersect V$.
    End.
  \end{proof}

  \begin{lemma}
    Let $S$ be a system of open sets.
    Then $\SETunionover S$ is open.
  \end{lemma}
  \begin{proof}
    Let $n \Elem \SETunionover S$.
    Take a set $M$ such that $n \Elem M \Elem S$.
    Consider a $q$ such that $\ArithSeq{n}{q} \SETinclude M$.
    Then $\ArithSeq{n}{q} \SETinclude \SETunionover S$.
  \end{proof}
\end{forthel}

Now that we have a topology of open sets on $\Nat$, we can continue
with a characterization of closed sets whose key property is that they are
closed under finite unions.

\begin{forthel}
  \begin{definition}[for=closed]
    Let $A$ be a subset of $\Nat$.
    $A$ is closed iff $\compl{A}$ is open.
  \end{definition}

  \begin{definition}[for=system of closed sets]
    A system of closed sets is a system of sets $S$ such that every element of
    $S$ is a closed subset of $\Nat$.
  \end{definition}

  \begin{lemma}
    Every system of closed sets is a set.
  \end{lemma}
  \begin{proof}
    Let $S$ be a system of closed sets.
    Then $S \SETinclude \SETpow(\Nat)$.
    $\SETpow(\Nat)$ is a set.
    Hence $S$ is a set.
  \end{proof}

  \begin{lemma}
    Let $S$ be a finite system of closed sets.
    Then $\SETunionover S$ is closed.
  \end{lemma}
  \begin{proof}
    Define $C \DefEq \CClass{X}{X \text{ is a closed subset of } \Nat}$.

    Let us show that $A \SETunion B \Elem C$ for any $A, B \Elem C$.
      Let $A, B \Elem C$.
      Then $A, B$ are closed subsets of $\Nat$.
      We have $(\compl{A \SETunion B}) \Eq \compl{A} \SETintersect \compl{B}$. %!
      $\compl{A}$ and $\compl{B}$ are open.
      Hence $\compl{A} \SETintersect \compl{B}$ is open.
      Thus $A \SETunion B$ is a closed subset of $\Nat$.
    End.

    Therefore $C$ is closed under finite unions.
    Consequently $\SETunionover S \Elem C$.
    Indeed $S$ is a subset of $C$.
  \end{proof}
\end{forthel}

An important step towards Furstenberg's proof is to show that arithmetic
sequences are closed.

\begin{forthel}
  \begin{lemma}
    $\ArithSeq{n}{q}$ is closed.
  \end{lemma}
  \begin{proof}
    Let $m \Elem \compl{\ArithSeq{n}{q}}$.

    Let us show that $\ArithSeq{m}{q} \SETinclude \compl{\ArithSeq{n}{q}}$.
      Let $k \Elem \ArithSeq{m}{q}$.
      Assume $k \NotElem \compl{\ArithSeq{n}{q}}$.
      Then $\NATcong{k}{m}{q}$ and $\NATcong{n}{k}{q}$.
      Hence $\NATcong{m}{n}{q}$.
      Therefore $m \Elem \ArithSeq{n}{q}$.
      Contradiction.
    End.
  \end{proof}
\end{forthel}

Identifying each prime number $p$ with the arithmetic sequence $\ArithSeq{0}{p}$
yields a bijection between the set $\Prime$ of all prime numbers and the set
$\PrimeSeq$ of all such sequences $\ArithSeq{0}{p}$.
Thus to show that there are infinitely many primes it suffices to show that
$\PrimeSeq$ is infinite.

\begin{forthel}
  \begin{definition}[for=PrimeSeq]
    $\PrimeSeq \DefEq \CClass{\ArithSeq{\NATzero}{p}}{p \Elem \Prime}$.
  \end{definition}

  \begin{lemma}
    $\PrimeSeq$ is a system of closed sets.
  \end{lemma}
  \begin{proof}
    $\ArithSeq{\NATzero}{p}$ is a closed subset of $\Nat$ for every $p \Elem \Prime$.
  \end{proof}

  \begin{lemma}
    $\PrimeSeq$ is a set that is equinumerous to $\Prime$.
  \end{lemma}
  \begin{proof}
    (1) $\PrimeSeq$ is a set.
    Indeed $\PrimeSeq \SETinclude \SETpow(\Nat)$.

    (2) $\PrimeSeq$ is equinumerous to $\Prime$.
    \begin{proof}
      Define $f(p) \DefEq \ArithSeq{\NATzero}{p}$ for $p \Elem \Prime$.

      Let us show that $f$ is injective.
        Let $p, q \Elem \Prime$.
        Assume $f(p) \Eq f(q)$.
        Then $\ArithSeq{\NATzero}{p} \Eq \ArithSeq{\NATzero}{q}$.
        We have $\ArithSeq{\NATzero}{p} \Eq \SClass{m}{\Nat}{\NATcong{m}{\NATzero}{p}}$ and
        $\ArithSeq{\NATzero}{q} =\linebreak \SClass{m}{\Nat}{\NATcong{m}{\NATzero}{q}}$.

        We can show that for all $m \Elem \Nat$ we have $p \NATmid m$ iff $q \NATmid m$.
          Let $m \Elem \Nat$.
          Then $\NATcong{m}{\NATzero}{p}$ iff $\NATcong{m}{\NATzero}{q}$.
          Thus $m \NATmod p \Eq \NATzero \NATmod p$ iff $m \NATmod q \Eq\linebreak \NATzero \NATmod q$.
          We have $\NATzero \NATmod p \Eq \NATzero \Eq \NATzero \NATmod q$.
          Hence $m \NATmod p \Eq \NATzero$ iff $m \NATmod q \Eq\linebreak \NATzero$.
          Therefore $p \NATmid m$ iff $q \NATmid m$.
        End.

        Consequently $p \Eq q$.
      End.

      $f$ is surjective onto $\PrimeSeq$.
      Thus $f$ is a bijection between $\Prime$ and $\PrimeSeq$.
    \end{proof}
  \end{proof}

  \begin{theorem}[title=Furstenberg,name=Furstenberg]
    $\Prime$ is infinite.
  \end{theorem}
  \begin{proof}
    $\SETunionover \PrimeSeq$ is a subset of $\Nat$.

    Let us show that for any $n \Elem \Nat$ we have $n \Elem \SETunionover \PrimeSeq$ iff $n$
    has a prime divisor.
      Let $n \Elem \Nat$.

      If $n$ has a prime divisor then $n$ belongs to $\SETunionover \PrimeSeq$.
      \begin{proof}
        Assume $n$ has a prime divisor.
        Take a prime divisor $p$ of $n$.
        We have $\ArithSeq{\NATzero}{p} \Elem \PrimeSeq$.
        Hence $n \Elem \ArithSeq{\NATzero}{p}$.
      \end{proof}

      If $n$ belongs to $\SETunionover \PrimeSeq$ then $n$ has a prime divisor.
      \begin{proof}
        Assume that $n$ belongs to $\SETunionover \PrimeSeq$.
        Take a prime number $r$ such that $n \Elem \ArithSeq{\NATzero}{r}$.
        Hence $\NATcong{n}{\NATzero}{r}$.
        Thus $n \NATmod r \Eq \NATzero \NATmod r \Eq \NATzero$.
        Therefore $r$ is a prime divisor of $n$.
      \end{proof}
    End.

    Hence For all $n \Elem \Nat$ we have $n \Elem \compl{\SETunionover \PrimeSeq}$ iff
    $n$ has no prime divisor.
    $\NATone$ has no prime divisor and any natural number having no prime
    divisor is equal to $\NATone$.
    Therefore $\compl{\SETunionover \PrimeSeq} \Eq \SETsingleton{\NATone}$.
    Indeed $\compl{\SETunionover \PrimeSeq} \SETinclude \SETsingleton{\NATone}$ and $\SETsingleton{\NATone}
    \SETinclude \compl{\SETunionover \PrimeSeq}$.

    $\PrimeSeq$ is infinite.
    \begin{proof}[method=contradiction]
      Assume that $\PrimeSeq$ is finite.
      Then $\SETunionover \PrimeSeq$ is closed and $\compl{\SETunionover \PrimeSeq}$ is open.
      Take a $p$ such that $\ArithSeq{\NATone}{p} \SETinclude \compl{\SETunionover \PrimeSeq}$.
      $\NATone \NATplus p$ is an element of $\ArithSeq{\NATone}{p}$.
      Indeed $\NATcong{\NATone \NATplus p}{\NATone}{p}$
      (by \sn{congruency of sum}).
      $\NATone \NATplus p$ is not equal to $\NATone$.
      Hence $\NATone \NATplus p \NotElem \compl{\SETunionover \PrimeSeq}$.
      Contradiction.
    \end{proof}
  \end{proof}
\end{forthel}

\printbibliography
\printcopyright{Andrei Paskevich (2008), Marcel Sch√ºtz (2021--2025)}
\end{smodule}
\end{document}
