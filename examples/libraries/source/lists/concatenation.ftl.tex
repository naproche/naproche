\documentclass[10pt]{article}
\usepackage[english]{babel}
\usepackage{../../../meta-inf/lib/naproche}
\input{../../lib/libraries}
\input{../../lib/lists}
\begin{document}
  \begin{imports}
    \begin{forthel}
      %[prove off][check off]
      [read \path{libraries/source/lists/lists.ftl.tex}]
      %[prove on][check on]
    \end{forthel}
  \end{imports}


  \section*{Concatenation}

  \begin{forthel}
    \begin{signature}[id=LISTS_CONCAT_4578620297183232,printid]
      Let $L, L'$ be lists.
      $L \concat L'$ is a list.
    \end{signature}
  \end{forthel}

  \begin{forthel}
    \begin{axiom}[id=LISTS_CONCAT_3703161885818880,printid]
      Let $L$ be a list.
      Then $\nil \concat L = L$.
    \end{axiom}
  \end{forthel}

  \begin{forthel}
    \begin{axiom}[id=LISTS_CONCAT_8050301789536256,printid]
      Let $a$ be an object and $L, L'$ be lists.
      Then $(a \cons L) \concat L' = a \cons (L \concat L')$.
    \end{axiom}
  \end{forthel}

  \begin{forthel}
    \begin{proposition}[id=LISTS_CONCAT_4512036658964875,printid]
      $L \concat \nil = L$ for every list $L$.
    \end{proposition}
    \begin{proof}[method=induction on $L$]
      Let $L$ be a list.

      Case $L = \nil$. Trivial.
      
      Case $L = a \cons L'$ for some object $a$ and some list $L'$.
        Consider an object $a$ and a list $L'$ such that $L = a \cons L'$.
        Then $L' \prec L$.
        Hence $L' \concat \nil = L'$.
        Thus $L \concat \nil
          = (a \cons L') \concat \nil
          = a \cons (L' \concat \nil)
          = a \cons L'
          = L$.
      End.
    \end{proof}
  \end{forthel}

  \begin{forthel}
    \begin{proposition}[id=LISTS_CONCAT_1021563255448756,printid]
      $L \concat (L' \concat L'') = (L \concat L') \concat L''$ for any lists $L, L', L''$.
    \end{proposition}
    \begin{proof}[method=induction on $L$]
      Let $L$ be a list.

      Case $L = \nil$. Trivial.

      Case $L = a \cons L'''$ for some object $a$ and some list $L'''$.
        Consider an object $a$ and a list $L'''$ such that $L = a \cons L'''$.
        Then $L''' \prec L$.
        Let $L',L''$ be lists.
        Then $L''' \concat (L' \concat L'') = (L''' \concat L') \concat L''$.
        [prover vampire]
        Thus $L \concat (L' \concat L'') 
          = (a \cons L''') \concat (L' \concat L'')
          = a \cons (L''' \concat (L' \concat L''))
          = a \cons ((L''' \concat L') \concat L'')
          = (a \cons (L''' \concat L')) \concat L''
          = ((a \cons L''') \concat L') \concat L''
          = (L \concat L') \concat L''$.
      End.
    \end{proof}
  \end{forthel}
\end{document}
